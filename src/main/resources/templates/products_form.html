<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <title>å•†å“ä¸€è¦§ | OshiGiftBox</title>

<style>
/* --- å…¨ã¦ã®è¦ç´ ã« box-sizing: border-box ã‚’é©ç”¨ã—ã¦ã€å¹…ã®è¨ˆç®—ã‚’æ­£ç¢ºã«ã—ã¾ã™ --- */
* {
Â  Â  box-sizing: border-box;Â 
}
/* ------------------------------------
Â  Â  1. å…±é€šãƒ™ãƒ¼ã‚¹ã‚¹ã‚¿ã‚¤ãƒ«
------------------------------------ */
Â  Â  body {
Â  Â  Â  Â  background-color: #ffd9ef;
Â  Â  Â  Â  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  padding: 0;
Â  Â  }

Â  Â  main {
Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  max-width: 900px;Â 
Â  Â  Â  Â  margin: 0 auto;
Â  Â  }

Â  Â  /* --- Header StyleÂ  --- */
Â  Â  header {
Â  Â  Â  Â  background-color: #159450;
Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  box-shadow: 0 2px 5px rgba(0,0,0,0.15);
Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  }
Â  Â  header img.home-icon {
Â  Â  Â  Â  width: 40px;
Â  Â  Â  Â  height: 40px;
Â  Â  Â  Â  border-radius: 20px;
Â  Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  header h1 {
Â  Â  Â  Â  color: white;
Â  Â  Â  Â  font-size: 1.8em;
Â  Â  Â  Â  margin: 0 0 0 15px;
Â  Â  Â  Â  flex-grow: 1;
Â  Â  }
Â  Â  header .left {
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  align-items: center;
Â  Â  }
Â  Â  header .user-icon {
Â  Â  Â  Â  width: 40px;
Â  Â  Â  Â  height: 40px;
Â  Â  Â  Â  border-radius: 20px;
Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  transition: transform 0.3s;
Â  Â  }
Â  Â  header .user-icon:hover {
Â  Â  Â  Â  transform: scale(1.1);
Â  Â  }
Â  Â Â 
Â  Â  /* ------------------------------------
Â  Â  Â  Â  2. ãƒšãƒ¼ã‚¸å›ºæœ‰ã®ã‚¹ã‚¿ã‚¤ãƒ« (å•†å“ä¸€è¦§)
Â  Â  ------------------------------------ */
Â  Â  h1 {
Â  Â  Â  Â  color: #a1835d;Â 
Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  margin-bottom: 30px;
Â  Â  Â  Â  margin-top: 0;
Â  Â  }

Â  Â  /* ğŸ’¡ ç™½ã„ãƒœãƒƒã‚¯ã‚¹ã®ã‚¹ã‚¿ã‚¤ãƒ« (ãƒªã‚¹ãƒˆå…¨ä½“ã‚’å›²ã‚€) */
Â  Â  .list-card {
Â  Â  Â  Â  background-color: #fff;
Â  Â  Â  Â  width: 100%;Â 
Â  Â  Â  Â  max-width: 750px;
Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  box-shadow: 0 4px 8px rgba(122, 111, 219, 0.2);
Â  Â  Â  Â  text-align: center;
Â  Â  }

Â  Â  .list-card h2 {
Â  Â  Â  Â  color: #7a6fdb;
Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  font-size: 1.5em;
Â  Â  Â  Â  margin-top: 0;
Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  }

Â  Â  /* å•†å“ãƒªã‚¹ãƒˆ (ul) ã®ã‚¹ã‚¿ã‚¤ãƒ« */
Â  Â  #productList {
Â  Â  Â  Â  list-style: none;
Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  text-align: left;
Â  Â  }

Â  Â  /* å€‹åˆ¥å•†å“ã‚¢ã‚¤ãƒ†ãƒ  (li) ã®ã‚¹ã‚¿ã‚¤ãƒ« */
Â  Â  #productList li {
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  padding: 15px 0;
Â  Â  Â  Â  border-bottom: 1px solid #eee;
Â  Â  }
Â  Â  #productList li:last-child {
Â  Â  Â  Â  border-bottom: none;
Â  Â  }

Â  Â  .product-info {
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  flex-grow: 1;
Â  Â  }

Â  Â  .product-info strong {
Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  margin-right: 15px;
Â  Â  Â  Â  min-width: 150px;
Â  Â  }
Â  Â  .product-info img {
Â  Â  Â  Â  margin-left: 10px;
Â  Â  Â  Â  object-fit: cover;
Â  Â  }

Â  Â  .actions {
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  min-width: 130px;
Â  Â  }

Â  Â  .edit-btn {
Â  Â  Â  Â  background-color: #60c5ba;
Â  Â  Â  Â  color: white;
Â  Â  Â  Â  padding: 6px 12px;
Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  text-decoration: none;
Â  Â  Â  Â  font-size: 0.9em;
Â  Â  Â  Â  transition: background-color 0.3s;
Â  Â  Â  Â  font-weight: 600;
Â  Â  }
Â  Â  .edit-btn:hover {
Â  Â  Â  Â  background-color: #4a9e96;
Â  Â  }

Â  Â  .actions button {
Â  Â  Â  Â  background-color: #ff7f7f;
Â  Â  Â  Â  color: white;
Â  Â  Â  Â  border: none;
Â  Â  Â  Â  padding: 6px 12px;
Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  font-size: 0.9em;
Â  Â  Â  Â  transition: background-color 0.3s;
Â  Â  Â  Â  font-weight: 600;
Â  Â  }
Â  Â  .actions button:hover {
Â  Â  Â  Â  background-color: #e55e5e;
Â  Â  }

Â  Â  /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ */
Â  Â  #messageBox {
Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  display: none; 
Â  Â  Â  Â  font-weight: 600;
Â  Â  }
Â  Â  .success {
Â  Â  Â  Â  background-color: #e6ffe6;
Â  Â  Â  Â  color: #4CAF50;
Â  Â  Â  Â  border: 1px solid #4CAF50;
Â  Â  }
Â  Â  .error {
Â  Â  Â  Â  background-color: #ffe6e6;
Â  Â  Â  Â  color: #f44336;
Â  Â  Â  Â  border: 1px solid #f44336;
Â  Â  }

Â  Â  /* ------------------------------------
Â  Â  Â  Â  3. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ
Â  Â  ------------------------------------ */
Â  Â  @media screen and (max-width: 600px) {
Â  Â  Â  Â  .list-card {
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â  #productList li {
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: flex-start;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .product-info {
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: flex-start;
Â  Â  Â  Â  }
Â  Â  Â  Â  .actions {
Â  Â  Â  Â  Â  Â  justify-content: flex-end;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  }
Â  Â  }
</style>
</head>

<body>
Â  Â  <header>
Â  Â  Â  Â  <div class="left">
Â  Â  Â  Â  Â  Â  <a th:href="@{/}" href="/">
Â  Â  Â  Â  Â  Â  Â  Â  <img src="/images/homebotan.jpg" alt="ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã¸æˆ»ã‚‹" class="home-icon" />
Â  Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  Â  Â  <h1>OshiGiftBox</h1>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="user-links">
Â  Â  Â  Â  Â  Â  <a th:href="@{/users/auth_select}">
Â  Â  Â  Â  Â  Â  Â  Â  <img src="/images/yuza.jpg" alt="ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²" class="user-icon" />
Â  Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  </div>
Â  Â  </header>
Â  Â  <main>
Â  Â  Â  Â  <h1>å•†å“ä¸€è¦§</h1>

Â  Â  Â  Â  <div class="list-card">
Â  Â  Â  Â  Â  Â  <h2>ğŸ“¦ ç™»éŒ²æ¸ˆã¿å•†å“ãƒªã‚¹ãƒˆ</h2>

Â  Â  Â  Â  Â  Â  <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ (Thymeleafã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚ã‚Œã°è¡¨ç¤º) -->
Â  Â  Â  Â  Â  Â  <div id="messageBox" th:if="${message}" th:text="${message}" th:classappend="${messageType ?: 'success'}" style="display: block;"></div>
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  <ul id="productList">
                <!-- ğŸ’¡ Thymeleafã«ã‚ˆã‚‹ãƒ«ãƒ¼ãƒ—å‡¦ç†ã‚’ã“ã“ã«è¿½åŠ ã—ã¾ã™ -->
                <li th:if="${#lists.isEmpty(products)}" style="text-align: center; color: #7a6fdb; font-weight: 600; padding: 15px;">
                    å•†å“ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
                </li>

Â  Â  Â  Â  Â  Â  Â  Â  <li th:each="product, stat : ${products}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="product-info">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- stat.index ã¯ 0 å§‹ã¾ã‚Šãªã®ã§ã€ +1 ã—ã¦é€£ç•ªã«ã™ã‚‹ -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong><span th:text="${stat.count} + '. ' + ${product.name}">1. æŠ¹èŒ¶ãƒã‚«ãƒ­ãƒ³</span></strong>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-top: 5px; font-size: 0.9em; color: #555;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ï¼ˆ<span th:text="${#numbers.formatInteger(product.price, 1, 'COMMA')}">1,200</span>å††ï¼‰
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-left: 20px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- ç”»åƒãƒ‘ã‚¹ãŒnullã§ãªã‘ã‚Œã°ç”»åƒã‚’è¡¨ç¤ºã€‚ã‚¨ãƒ©ãƒ¼æ™‚ã«ã¯ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’è¡¨ç¤º -->
                            <img th:if="${product.imagePath}" th:src="${product.imagePath}" width="80" height="80" 
                                 onerror="this.onerror=null;this.src='https://placehold.co/80x80/cccccc/ffffff?text=No+Img';" 
                                 style="border-radius: 8px;" alt="å•†å“ç”»åƒ"/>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="actions">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <a th:href="@{/products/edit/{id}(id=${product.id})}" class="edit-btn">ç·¨é›†</a>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- å‰Šé™¤ãƒœã‚¿ãƒ³ã¯JSã§å‡¦ç†ã™ã‚‹ãŸã‚ã€idã‚’dataå±æ€§ã«æŒã¤ã‚ˆã†ã«å¤‰æ›´ -->
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" class="delete-btn" th:data-id="${product.id}">å‰Šé™¤</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </li>

Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  </div>
Â  Â  </main>

Â  Â  <script>
// -----------------------------------------------------------
// ğŸ’¡ Thymeleafã§ãƒªã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸãŸã‚ã€JSã§ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ã¯ä¸è¦ã§ã™ã€‚
//    ã“ã“ã§ã¯å‰Šé™¤å‡¦ç†ã®ã¿ã‚’å®Ÿè£…ã—ã¾ã™ã€‚
// -----------------------------------------------------------

// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºé–¢æ•°
function displayMessage(message, type = 'success') {
Â  Â  const box = document.getElementById('messageBox');
Â  Â  box.textContent = message;
Â  Â  box.className = type; // ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨
Â  Â  box.style.display = 'block';
Â  Â  // 3ç§’å¾Œã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ¶ˆã™
Â  Â  setTimeout(() => {
Â  Â  Â  Â  box.style.display = 'none';
Â  Â  }, 3000);
}

// å‰Šé™¤å‡¦ç†ã®é–¢æ•°
function deleteProduct(id) {
    if (!confirm('æœ¬å½“ã«ã“ã®å•†å“ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
        return;
    }

    // å‰Šé™¤ç¢ºèªã®ãƒ­ã‚¸ãƒƒã‚¯ã¯çœç•¥ã—ã€å³åº§ã«å‡¦ç†å®Ÿè¡Œã‚’æ¨¡æ“¬ã—ã¾ã™
    console.log("å•†å“ID:", id, "ã‚’å‰Šé™¤ã—ã¾ã™...");
    
    // å®Ÿéš›ã«ã¯Fetch APIã‚’ä½¿ã£ã¦ã‚µãƒ¼ãƒãƒ¼ã«å‰Šé™¤ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚Šã¾ã™
    fetch(`/products/${id}`, { method: 'DELETE' }) // DELETEãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨
Â  Â  Â  Â  .then(res => {
Â  Â  Â  Â  Â  Â  if (res.ok) {
                // æˆåŠŸã—ãŸã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã€ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ãƒªã‚¹ãƒˆã‚’æ›´æ–°
Â  Â  Â  Â  Â  Â  Â  Â  displayMessage('å•†å“ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚', 'success');
                // ãƒšãƒ¼ã‚¸ã®å†èª­ã¿è¾¼ã¿
                setTimeout(() => window.location.reload(), 500);
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  displayMessage('å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚', 'error');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  })
Â  Â  Â  Â  .catch(err => {
Â  Â  Â  Â  Â  Â  console.error('ã‚¨ãƒ©ãƒ¼:', err);
Â  Â  Â  Â  Â  Â  displayMessage('å‰Šé™¤å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚', 'error');
Â  Â  Â  Â  });
}

// ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
window.onload = function() {
    // å‰Šé™¤ãƒœã‚¿ãƒ³ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’ä¸€æ‹¬è¨­å®š
    document.querySelectorAll('.delete-btn').forEach(button => {
        button.addEventListener('click', function() {
            const productId = this.getAttribute('data-id');
            deleteProduct(productId);
        });
    });

    // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–å¾—ã—è¡¨ç¤ºï¼ˆãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆæ™‚ãªã©ï¼‰
    const urlParams = new URLSearchParams(window.location.search);
    const message = urlParams.get('message');
    const messageType = urlParams.get('type') || 'success';

    if (message) {
        displayMessage(decodeURIComponent(message), messageType);
    }
};
Â  Â  </script>
</body>
</html>
