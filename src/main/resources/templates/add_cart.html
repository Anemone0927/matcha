<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
Â  <meta charset="UTF-8" />
Â  <title>ã‚«ãƒ¼ãƒˆã«å•†å“ã‚’è¿½åŠ  | æ¨ã—ç³»é£Ÿã¹ç‰©é€šè²©ã‚µã‚¤ãƒˆ</title>
Â  <style>
Â  Â  body {
Â  Â  Â  background-color: #ffd9ef;
Â  Â  Â  color: #2f4f2f;
Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  margin: 0;
Â  Â  Â  padding: 0;
Â  Â  }

Â  Â  Â  Â  main {
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  max-width: 900px;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- Header Style --- */
Â  Â  Â  Â  header {
Â  Â  Â  Â  Â  Â  background-color: #159450;
Â  Â  Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 5px rgba(0,0,0,0.15);
Â  Â  Â  Â  Â  Â  margin-bottom: 20px; /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨ã®åŒºåˆ‡ã‚Š */
Â  Â  Â  Â  }
Â  Â  Â  Â  header img.home-icon {
Â  Â  Â  Â  Â  Â  width: 40px;
Â  Â  Â  Â  Â  Â  height: 40px;
Â  Â  Â  Â  Â  Â  border-radius: 20px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  }
Â  Â  Â  Â  header h1 {
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  font-size: 1.8em;
Â  Â  Â  Â  Â  Â  margin: 0 0 0 15px;
Â  Â  Â  Â  Â  Â  flex-grow: 1;
Â  Â  Â  Â  }
Â  Â  Â  Â  header .left {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  header .user-icon {
Â  Â  Â  Â  Â  Â  width: 40px;
Â  Â  Â  Â  Â  Â  height: 40px;
Â  Â  Â  Â  Â  Â  border-radius: 20px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: transform 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â  header .user-icon:hover {
Â  Â  Â  Â  Â  Â  transform: scale(1.1);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- Button Style --- */
Â  Â  Â  Â  a.btn {
Â  Â  Â  Â  Â  Â  background-color: #fff;
Â  Â  Â  Â  Â  Â  color: #2f4f2f;
Â  Â  Â  Â  Â  Â  border: 2px solid #2f4f2f;
Â  Â  Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  Â  Â  margin: 5px;
Â  Â  Â  Â  Â  Â  font-size: 1em;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  text-decoration: none;
Â  Â  Â  Â  Â  Â  display: inline-block;
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s, color 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â  a.btn:hover {
Â  Â  Â  Â  Â  Â  background-color: #2f4f2f;
Â  Â  Â  Â  Â  Â  color: #fff;
Â  Â  Â  Â  }


Â  Â  Â  Â  /* ====================================
Â  Â  Â  Â  Â  Â 2. ãƒšãƒ¼ã‚¸å›ºæœ‰ã®ã‚¹ã‚¿ã‚¤ãƒ« (review_list.html)
Â  Â  Â  Â  Â  Â ==================================== */
Â  Â  h1 {
Â  Â  Â  text-align: center;
Â  Â  }
Â  Â  form {
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  gap: 15px;
Â  Â  }
Â  Â  label {
Â  Â  Â  font-weight: bold;
Â  Â  }
Â  Â  /* ğŸ’¡ selectã‚¿ã‚°ã«ã‚‚ã‚¹ã‚¿ã‚¤ãƒ«ãŒé©ç”¨ã•ã‚Œã‚‹ã‚ˆã†ã«è¿½è¨˜ */
Â  Â  input[type="number"], input[type="text"], select {
Â  Â  Â  padding: 8px;
Â  Â  Â  border: 1px solid #2f4f2f;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  font-size: 1em;
Â  Â  Â  background-color: white; /* selectã®èƒŒæ™¯è‰²ã‚’ç™½ã« */
Â  Â  }
Â  Â  button {
Â  Â  Â  background-color: #2f4f2f;
Â  Â  Â  color: white;
Â  Â  Â  padding: 12px;
Â  S Â  Â  border: none;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  font-size: 1.1em;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: background-color 0.3s ease;
Â  Â  }
Â  Â  button:hover {
Â  Â  Â  background-color: #1f2f1f;
Â  Â  }

Â  Â  Â  Â  /* ====================================
Â  Â  Â  Â  Â  Â 3. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ
Â  Â  Â  Â  Â  Â ==================================== */
Â  Â  Â  Â  @media screen and (max-width: 480px) {
Â  Â  Â  Â  Â  Â  header h1 {
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 1.5em;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  .review-card {
Â  Â  Â  Â  Â  Â  Â  Â  margin: 10px 5px;
Â  Â  Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  /* ãã®ä»–ãƒ¢ãƒã‚¤ãƒ«èª¿æ•´ */
Â  Â  Â  Â  Â  Â  input[type="text"],
Â  Â  Â  Â  Â  Â  input[type="number"], 
Â  Â  Â  Â  Â  Â  select { /* ğŸ’¡ selectã‚‚ */
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  button {
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  </style>
</head>
<body>
Â  Â  <!-- å…±é€šãƒ˜ãƒƒãƒ€ãƒ¼ -->
Â  Â  <header>
Â  Â  Â  Â  <div class="left">
Â  Â  Â  Â  Â  Â  <a th:href="@{/}">
Â  Â  Â  Â  Â  Â  Â  Â  <img src="/images/homebotan.jpg" alt="ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã¸æˆ»ã‚‹" class="home-icon" />
Â  Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  Â  Â  <h1>OshiGiftBox</h1>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="user-links">
Â  Â  Â  Â  Â  Â  <a th:href="@{/users/auth_select}">
Â  Â  Â  Â  Â  Â  Â  Â  <img src="/images/yuza.jpg" alt="ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²" class="user-icon" />
Â  Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  </div>
Â  Â  </header>
Â  Â  <main>
<div style="text-align: center; color: #2f4f2f; margin-top: 20px; padding: 30px; background-color: #fff; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.15); max-width: 400px; margin-left: auto; margin-right: auto;">
Â  Â  <h1 style="color: #a1835d; font-size: 1.5em; margin-bottom: 20px;">ğŸ›’ ã‚«ãƒ¼ãƒˆã«å•†å“ã‚’è¿½åŠ </h1>
Â  Â  
Â  Â  <!-- ğŸ’¡ ä¿®æ­£ç‚¹ 1: ãƒ•ã‚©ãƒ¼ãƒ ã® th:action ã¨ method ã‚’å‰Šé™¤ (JavaScriptã§å‡¦ç†ã™ã‚‹ãŸã‚) -->
Â  Â  <form id="addCartForm" style="display: flex; flex-direction: column; gap: 15px; text-align: left;">
Â  Â  Â  Â Â 
Â  Â  Â  Â  <!-- ğŸ’¡ ä¿®æ­£ç‚¹ 2: ã€Œå•†å“IDã€ã®å…¥åŠ›æ¬„ã‚’ã€Œå•†å“ã€ã®ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆã«å¤‰æ›´ -->
Â  Â  Â  Â  <div style="display: flex; flex-direction: column;">
Â  Â  Â  Â  Â  Â  <label for="productId" style="font-weight: bold; margin-bottom: 5px;">å•†å“</label>
Â  Â  Â  Â  Â  Â  <!-- input ã‚’ select ã«å¤‰æ›´ -->
Â  Â  Â  Â  Â  Â  <select id="productId" name="productId" requiredÂ 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â style="padding: 10px; border: 1px solid #ccc; border-radius: 5px; background-color: white; font-size: 1em;">
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  <!-- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é¸æŠè‚¢ -->
Â  Â  Â  Â  Â  Â  Â  Â  <option value="" disabled selected>-- å•†å“ã‚’é¸ã‚“ã§ãã ã•ã„ --</option>
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  <!-- Thymeleafã§Controllerã‹ã‚‰æ¸¡ã•ã‚ŒãŸ 'allProducts' ã‚’ãƒ«ãƒ¼ãƒ—å‡¦ç† -->
Â  Â  Â  Â  Â  Â  Â  Â  <option th:each="product : ${allProducts}"Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  th:value="${product.id}"Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  th:text="${product.name} + ' (' + ${product.price} + 'å††)'">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <!-- (ä¾‹: ã‚­ãƒ£ãƒ³ãƒ‡ã‚£ (150å††)) -->
Â  Â  Â  Â  Â  Â  Â  Â  </option>
Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div style="display: flex; flex-direction: column;">
Â  Â  Â  Â  Â  Â  <label for="quantity" style="font-weight: bold; margin-bottom: 5px;">æ•°é‡</label>
Â  Â  Â  Â  Â  Â  <input type="number" id="quantity" name="quantity" min="1" value="1" requiredÂ 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â style="padding: 10px; border: 1px solid #ccc; border-radius: 5px;" />
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <button type="submit"Â 
Â  Â  Â  Â  Â  Â  Â  Â  style="background-color: #2f4f2f; color: white; padding: 12px; border: none; border-radius: 5px; font-size: 1.1em; cursor: pointer; transition: background-color 0.3s;">
Â  Â  Â  Â  Â  Â  ã‚«ãƒ¼ãƒˆã«è¿½åŠ ã™ã‚‹
Â  Â  Â  Â  </button>
Â  Â  </form>
</div>

<script>
Â  // ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡ã‚’Ajaxã§è¡Œã„ãƒšãƒ¼ã‚¸é·ç§»ã—ãªã„ã‚ˆã†ã«ã™ã‚‹
Â  document.getElementById('addCartForm').addEventListener('submit', function(e) {
Â  Â  e.preventDefault(); // ãƒ•ã‚©ãƒ¼ãƒ ã®é€šå¸¸ã®é€ä¿¡ã‚’åœæ­¢

Â  Â  const productId = document.getElementById('productId').value;
Â  Â  const quantity = document.getElementById('quantity').value;

Â  Â  // ğŸ’¡ ä¿®æ­£ç‚¹ 3: é€ä¿¡ã™ã‚‹JSONã®å½¢å¼ã‚’å¤‰æ›´
Â  Â  // CartControllerã®@RequestBody CartItem item ãŒã€
Â  Â  // CartItemã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å†…ã® "Product" ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã®é–¢é€£ä»˜ã‘ã‚’
Â  Â  // æ­£ã—ãè§£é‡ˆã§ãã‚‹ã‚ˆã†ã«ã€JSONã‚’ãƒã‚¹ãƒˆã•ã›ã¾ã™ã€‚
Â  Â  const requestBody = {
Â  Â  Â  product: {
Â  Â  Â  Â  id: Number(productId) // é¸æŠã•ã‚ŒãŸIDã‚’ product.id ã¨ã—ã¦é€ä¿¡
Â  Â  Â  },
Â  Â  Â  quantity: Number(quantity)
Â  Â  };

Â  Â  fetch('/api/cart', {
Â  Â  Â  method: 'POST',
Â  Â  Â  headers: {
Â  Â  Â  Â  'Content-Type': 'application/json'
Â  Â  Â  },
Â  Â  Â  body: JSON.stringify(requestBody) // ğŸ’¡ ä¿®æ­£ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£
Â  Â  })
Â  Â  .then(res => {
Â  Â  Â  if (!res.ok) {
Â  Â  Â  Â  // ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦èª­ã¿å–ã‚‹
Â  Â  Â  Â  return res.text().then(text => { throw new Error(`è¿½åŠ å¤±æ•—: ${text}`) });
Â  Â  Â  }
Â  Â  Â  return res.json();
Â  Â  })
Â  Â  .then(data => {
Â  Â  Â  // ğŸ’¡ æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…·ä½“çš„ã«
Â  Â  Â  // ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‹ã‚‰é¸æŠã•ã‚ŒãŸå•†å“ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
Â  Â  Â  const selectedOption = document.getElementById('productId').options[document.getElementById('productId').selectedIndex];
Â  Â  Â  const productName = selectedOption.text.split(' (')[0]; // '(150å††)' ã®éƒ¨åˆ†ã‚’é™¤å»
Â  Â  Â  
Â  Â  Â  alert(`${productName} ã‚’ ${quantity} ç‚¹ã‚«ãƒ¼ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸï¼`);
Â  Â  Â  
Â  Â  Â  // ãƒ•ã‚©ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ
Â  Â  Â  this.reset();
Â  Â  })
Â  Â  .catch(err => {
Â  Â  Â  console.error('ã‚«ãƒ¼ãƒˆè¿½åŠ ã‚¨ãƒ©ãƒ¼:', err);
Â  Â  Â  alert('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + err.message);
Â  Â  });
Â  });
</script>
Â  Â  </main>
</body>
</html>